name: 'test'
on:   ['push', 'pull_request']
jobs:
  test:
    strategy:
      fail-fast: false
      matrix: {os: ['ubuntu-latest', 'macos-latest', 'windows-latest']}

    runs-on: ${{ matrix.os }}
    steps:
    - uses: 'actions/checkout@v4'
    - {uses: 'actions/setup-go@v5', with: {go-version: '1.24'}}
    - {uses: 'toml-lang/setup-toml-test@main', with: {decoder: 'toml2json', version: 'main'}}
    - if:  runner.os != 'Windows'
      run: 'make check CC=clang'
    - if:  runner.os == 'Windows'
      run: 'make check CC=gcc SANITIZER='
